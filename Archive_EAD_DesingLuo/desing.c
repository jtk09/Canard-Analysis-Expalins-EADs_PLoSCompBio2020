/*
 *  desing_avf.c
 *
 *  AUTO C file for the vector field named: desing
 *
 *  This file was generated by the program VFGEN, version: 2.5.0
 *  Generated on 17-Feb-2020 at 10:49
 */

#include <math.h>
#include "auto_f2c.h"

/*
 *  FUNC  Defines the vector field and its derivatives
 */

int func(integer ndim_, const doublereal *u_, const integer *icp_,
         const doublereal *par_, integer ijac_,
         doublereal *f_, doublereal *dfdu_, doublereal *dfdp_)
{
    integer dfdu__dim1, dfdp__dim1;
    const double Ki = 145.0;
    const double Nao = 140.0;
    const double Nai = 18.0;
    const double PRNaK = 1.8329999999999999e-02;
    const double R = 8.3144626181532395e+00;
    const double Kelvin = 3.1014999999999998e+02;
    const double Faraday = 9.6485332900000003e+01;
    const double cda = 9.5000000000000001e-02;
    const double cdb = 7.0000000000000007e-02;
    const double cfa = 1.2000000000000000e-02;
    const double cfb = 6.4999999999999997e-03;
    const double cxa = 5.0000000000000001e-04;
    const double cxb = 1.2999999999999999e-03;
    const double cxi = 2.8370000000000002e+00;
    const double cK1a = 1.0200000000000000e+00;
    const double cK1b = 4.9124000000000001e-01;
    const double Vda = -5.0000000000000000e+00;
    const double Vdb = 4.4000000000000000e+01;
    const double Vfa = 2.8000000000000000e+01;
    const double Vfb = 3.0000000000000000e+01;
    const double Vxa = 5.0000000000000000e+01;
    const double Vxb = 2.0000000000000000e+01;
    const double Vxi1 = 7.7000000000000000e+01;
    const double Vxi2 = 3.5000000000000000e+01;
    const double sda1 = -1.0000000000000000e-02;
    const double sda2 = -7.1999999999999995e-02;
    const double sdb1 = -1.7000000000000001e-02;
    const double sdb2 = 5.0000000000000003e-02;
    const double sfa1 = -8.0000000000000002e-03;
    const double sfa2 = 1.4999999999999999e-01;
    const double sfb1 = -2.0000000000000000e-02;
    const double sfb2 = -2.0000000000000001e-01;
    const double sxa1 = 8.3000000000000004e-02;
    const double sxa2 = 5.7000000000000002e-02;
    const double sxb1 = -5.9999999999999998e-02;
    const double sxb2 = -4.0000000000000001e-02;
    const double sxi = 4.0000000000000001e-02;
    const double sK1a = 2.3849999999999999e-01;
    const double sK1b1 = 8.0320000000000003e-02;
    const double sK1b2 = 6.1749999999999999e-02;
    const double sK1b3 = -5.1429999999999998e-01;
    const double sKp = 1.6722408026755853e-01;
    const double gK1w = 6.0470000000000002e-01;
    const double gKp = 1.8300000000000000e-02;
    const double gb = 3.9210000000000002e-02;
    const double VKp = 7.4880000000000004e+00;
    const double Vb = 5.9869999999999997e+01;
    double V, x;
    double Ko, shiftd, shiftf, gKw, gCa, VCa;
    double gK, gK1, VK, VK1, alphad_inf, betad_inf, alphad_tau, betad_tau, alphaf_inf, betaf_inf, alphaf_tau, betaf_tau, alphax, betax, tauf, taux, dinf, finf, xinf, xi, alphaK1, betaK1, K1inf, Kp, IK, IK1, IKp, Ib, fCrit;
    double dfdt, dxdt, dFdV, dFdf, dFdx;

    dfdu__dim1 = ndim_;
    dfdp__dim1 = ndim_;

    V          = u_[0];
    x          = u_[1];

    Ko         = par_[0];
    shiftd     = par_[1];
    shiftf     = par_[2];
    gKw        = par_[3];
    gCa        = par_[4];
    VCa        = par_[5];

    gK = 4.3033148291193524e-01*gKw*pow(Ko,(1.0/2.0));
    gK1 = 4.3033148291193524e-01*pow(Ko,(1.0/2.0))*gK1w;
    VK = log(( Ko+PRNaK*Nao)/( Ki+PRNaK*Nai))/Faraday*R*Kelvin;
    VK1 = 1.0/Faraday*R*Kelvin*log(Ko/Ki);
    alphad_inf = 1.0/( exp(sda2*( V+Vda-shiftd))+1.0)*cda*exp(sda1*( V+Vda-shiftd));
    betad_inf = exp(sdb1*( V-shiftd+Vdb))*cdb/( exp(sdb2*( V-shiftd+Vdb))+1.0);
    alphad_tau = exp(( V+Vda)*sda1)/( exp(sda2*( V+Vda))+1.0)*cda;
    betad_tau = 1.0/( exp(( V+Vdb)*sdb2)+1.0)*cdb*exp(sdb1*( V+Vdb));
    alphaf_inf = cfa*exp(sfa1*( V-shiftf+Vfa))/( exp(( V-shiftf+Vfa)*sfa2)+1.0);
    betaf_inf = cfb*exp(( Vfb+V-shiftf)*sfb1)/( exp(sfb2*( Vfb+V-shiftf))+1.0);
    alphaf_tau = cfa*exp(sfa1*( V+Vfa))/( exp(( V+Vfa)*sfa2)+1.0);
    betaf_tau = cfb*exp(( Vfb+V)*sfb1)/( exp(sfb2*( Vfb+V))+1.0);
    alphax = exp(sxa1*( V+Vxa))/( exp(sxa2*( V+Vxa))+1.0)*cxa;
    betax = exp(( V+Vxb)*sxb1)/( exp(sxb2*( V+Vxb))+1.0)*cxb;
    tauf = 1.0/( alphaf_tau+betaf_tau);
    taux = 1.0/( alphax+betax);
    dinf = alphad_inf/( alphad_inf+betad_inf);
    finf = 1.0/( betaf_inf+alphaf_inf)*alphaf_inf;
    xinf = alphax/( alphax+betax);
    xi = cxi*( exp(sxi*( Vxi1+V))-1.0)/( Vxi1+V)/exp(( V+Vxi2)*sxi);
    alphaK1 = 1.0/( exp(-sK1a*( VK1-V+5.9215000000000003e+01))+1.0)*cK1a;
    betaK1 = 1.0/( exp(-( VK1-V-4.7530000000000001e+00)*sK1b3)+1.0)*( exp(-sK1b2*( VK1-V+5.9430999999999995e+02))+cK1b*exp(-sK1b1*( VK1-V-5.4760000000000000e+00)));
    K1inf = 1.0/( alphaK1+betaK1)*alphaK1;
    Kp = 1.0/( exp(-sKp*( V-VKp))+1.0);

    IK = xi*gK*( V-VK)*x;
    IK1 = -( VK1-V)*K1inf*gK1;
    IKp = -( VK1-V)*Kp*gKp;
    Ib = gb*( V+Vb);

    /* manually added */
    fCrit = -(IK+IK1+IKp+Ib)/(gCa*dinf*(V-VCa));

    dfdt = (finf-fCrit)/tauf;
    dxdt = (xinf-x)/taux;
    dFdV = -gb+4.3033148291193524e-01*gKw*pow(Ko,(1.0/2.0))*cxi*( exp(sxi*( Vxi1+V))-1.0)/pow( Vxi1+V,2.0)*( V-log(( Ko+PRNaK*Nao)/( Ki+PRNaK*Nai))/Faraday*R*Kelvin)*x/exp(( V+Vxi2)*sxi)+4.3033148291193524e-01*gKw*pow(Ko,(1.0/2.0))*cxi*( exp(sxi*( Vxi1+V))-1.0)*sxi/( Vxi1+V)*( V-log(( Ko+PRNaK*Nao)/( Ki+PRNaK*Nai))/Faraday*R*Kelvin)*x/exp(( V+Vxi2)*sxi)-1.0/( exp(sda2*( V+Vda-shiftd))+1.0)*gCa*cda*fCrit*exp(sda1*( V+Vda-shiftd))/( 1.0/( exp(sda2*( V+Vda-shiftd))+1.0)*cda*exp(sda1*( V+Vda-shiftd))+exp(sdb1*( V-shiftd+Vdb))*cdb/( exp(sdb2*( V-shiftd+Vdb))+1.0))+( V-VCa)*( 1.0/( exp(sda2*( V+Vda-shiftd))+1.0)*cda*exp(sda1*( V+Vda-shiftd))*sda1+exp(sdb1*( V-shiftd+Vdb))*sdb1*cdb/( exp(sdb2*( V-shiftd+Vdb))+1.0)-exp(sdb2*( V-shiftd+Vdb))*exp(sdb1*( V-shiftd+Vdb))*sdb2*cdb/pow( exp(sdb2*( V-shiftd+Vdb))+1.0,2.0)-sda2/pow( exp(sda2*( V+Vda-shiftd))+1.0,2.0)*cda*exp(sda1*( V+Vda-shiftd))*exp(sda2*( V+Vda-shiftd)))/( exp(sda2*( V+Vda-shiftd))+1.0)*gCa*cda*fCrit*exp(sda1*( V+Vda-shiftd))/pow( 1.0/( exp(sda2*( V+Vda-shiftd))+1.0)*cda*exp(sda1*( V+Vda-shiftd))+exp(sdb1*( V-shiftd+Vdb))*cdb/( exp(sdb2*( V-shiftd+Vdb))+1.0),2.0)+-4.3033148291193524e-01*gKw*pow(Ko,(1.0/2.0))*cxi*sxi*exp(sxi*( Vxi1+V))/( Vxi1+V)*( V-log(( Ko+PRNaK*Nao)/( Ki+PRNaK*Nai))/Faraday*R*Kelvin)*x/exp(( V+Vxi2)*sxi)-sKp/pow( exp(-sKp*( V-VKp))+1.0,2.0)*exp(-sKp*( V-VKp))*gKp*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki))-( V-VCa)/( exp(sda2*( V+Vda-shiftd))+1.0)*gCa*cda*fCrit*exp(sda1*( V+Vda-shiftd))/( 1.0/( exp(sda2*( V+Vda-shiftd))+1.0)*cda*exp(sda1*( V+Vda-shiftd))+exp(sdb1*( V-shiftd+Vdb))*cdb/( exp(sdb2*( V-shiftd+Vdb))+1.0))*sda1+4.3033148291193524e-01*pow(Ko,(1.0/2.0))*exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9215000000000003e+01)*sK1a)/( ( cK1b*exp(sK1b1*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+5.4760000000000000e+00))+exp(sK1b2*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9430999999999995e+02)))/( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+4.7530000000000001e+00)*sK1b3)+1.0)+1.0/( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9215000000000003e+01)*sK1a)+1.0)*cK1a)*gK1w/pow( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9215000000000003e+01)*sK1a)+1.0,2.0)*cK1a*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki))*sK1a+4.3033148291193524e-01*( 1.0/( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+4.7530000000000001e+00)*sK1b3)+1.0)*( cK1b*sK1b1*exp(sK1b1*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+5.4760000000000000e+00))+sK1b2*exp(sK1b2*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9430999999999995e+02)))-exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9215000000000003e+01)*sK1a)/pow( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9215000000000003e+01)*sK1a)+1.0,2.0)*cK1a*sK1a-( cK1b*exp(sK1b1*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+5.4760000000000000e+00))+exp(sK1b2*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9430999999999995e+02)))/pow( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+4.7530000000000001e+00)*sK1b3)+1.0,2.0)*exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+4.7530000000000001e+00)*sK1b3)*sK1b3)*pow(Ko,(1.0/2.0))/pow( ( cK1b*exp(sK1b1*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+5.4760000000000000e+00))+exp(sK1b2*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9430999999999995e+02)))/( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+4.7530000000000001e+00)*sK1b3)+1.0)+1.0/( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9215000000000003e+01)*sK1a)+1.0)*cK1a,2.0)*gK1w/( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9215000000000003e+01)*sK1a)+1.0)*cK1a*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki))+-4.3033148291193524e-01*gKw*pow(Ko,(1.0/2.0))*cxi*( exp(sxi*( Vxi1+V))-1.0)/( Vxi1+V)*x/exp(( V+Vxi2)*sxi)+sda2*( V-VCa)/pow( exp(sda2*( V+Vda-shiftd))+1.0,2.0)*gCa*cda*fCrit*exp(sda1*( V+Vda-shiftd))/( 1.0/( exp(sda2*( V+Vda-shiftd))+1.0)*cda*exp(sda1*( V+Vda-shiftd))+exp(sdb1*( V-shiftd+Vdb))*cdb/( exp(sdb2*( V-shiftd+Vdb))+1.0))*exp(sda2*( V+Vda-shiftd))+-4.3033148291193524e-01*pow(Ko,(1.0/2.0))/( ( cK1b*exp(sK1b1*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+5.4760000000000000e+00))+exp(sK1b2*( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9430999999999995e+02)))/( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)+4.7530000000000001e+00)*sK1b3)+1.0)+1.0/( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9215000000000003e+01)*sK1a)+1.0)*cK1a)*gK1w/( exp(( V-1.0/Faraday*R*Kelvin*log(Ko/Ki)-5.9215000000000003e+01)*sK1a)+1.0)*cK1a-1.0/( exp(-sKp*( V-VKp))+1.0)*gKp;
    dFdf = -( V-VCa)/( exp(sda2*( V+Vda-shiftd))+1.0)*gCa*cda*exp(sda1*( V+Vda-shiftd))/( 1.0/( exp(sda2*( V+Vda-shiftd))+1.0)*cda*exp(sda1*( V+Vda-shiftd))+exp(sdb1*( V-shiftd+Vdb))*cdb/( exp(sdb2*( V-shiftd+Vdb))+1.0));
    dFdx = -4.3033148291193524e-01*gKw*pow(Ko,(1.0/2.0))*cxi*( exp(sxi*( Vxi1+V))-1.0)/( Vxi1+V)*( V-log(( Ko+PRNaK*Nao)/( Ki+PRNaK*Nai))/Faraday*R*Kelvin)/exp(( V+Vxi2)*sxi);

    /*
     *  The vector field
     */

    f_[0] = dFdf*dfdt + dFdx*dxdt;
    f_[1] = -dFdV*dxdt;

    return 0;
}

/*
 *  STPNT  Gives a starting point
 */

int stpnt(integer ndim_, doublereal t_, doublereal *u_, doublereal *par_)
{
    const double Ki = 145.0;
    const double Nao = 140.0;
    const double Nai = 18.0;
    const double PRNaK = 1.8329999999999999e-02;
    const double R = 8.3144626181532395e+00;
    const double Kelvin = 3.1014999999999998e+02;
    const double Faraday = 9.6485332900000003e+01;
    const double cda = 9.5000000000000001e-02;
    const double cdb = 7.0000000000000007e-02;
    const double cfa = 1.2000000000000000e-02;
    const double cfb = 6.4999999999999997e-03;
    const double cxa = 5.0000000000000001e-04;
    const double cxb = 1.2999999999999999e-03;
    const double cxi = 2.8370000000000002e+00;
    const double cK1a = 1.0200000000000000e+00;
    const double cK1b = 4.9124000000000001e-01;
    const double Vda = -5.0000000000000000e+00;
    const double Vdb = 4.4000000000000000e+01;
    const double Vfa = 2.8000000000000000e+01;
    const double Vfb = 3.0000000000000000e+01;
    const double Vxa = 5.0000000000000000e+01;
    const double Vxb = 2.0000000000000000e+01;
    const double Vxi1 = 7.7000000000000000e+01;
    const double Vxi2 = 3.5000000000000000e+01;
    const double sda1 = -1.0000000000000000e-02;
    const double sda2 = -7.1999999999999995e-02;
    const double sdb1 = -1.7000000000000001e-02;
    const double sdb2 = 5.0000000000000003e-02;
    const double sfa1 = -8.0000000000000002e-03;
    const double sfa2 = 1.4999999999999999e-01;
    const double sfb1 = -2.0000000000000000e-02;
    const double sfb2 = -2.0000000000000001e-01;
    const double sxa1 = 8.3000000000000004e-02;
    const double sxa2 = 5.7000000000000002e-02;
    const double sxb1 = -5.9999999999999998e-02;
    const double sxb2 = -4.0000000000000001e-02;
    const double sxi = 4.0000000000000001e-02;
    const double sK1a = 2.3849999999999999e-01;
    const double sK1b1 = 8.0320000000000003e-02;
    const double sK1b2 = 6.1749999999999999e-02;
    const double sK1b3 = -5.1429999999999998e-01;
    const double sKp = 1.6722408026755853e-01;
    const double gK1w = 6.0470000000000002e-01;
    const double gKp = 1.8300000000000000e-02;
    const double gb = 3.9210000000000002e-02;
    const double VKp = 7.4880000000000004e+00;
    const double Vb = 5.9869999999999997e+01;
    double V, x;
    double Ko, shiftd, shiftf, gKw, gCa, VCa;

    /* Change the parameter values and the starting point to correct values! */

    Ko = 5.4000000000000004e+00;
    shiftd = 0.0000000000000000e+00;
    shiftf = 0.0000000000000000e+00;
    gKw = 2.8199999999999997e-01;
    gCa = 0.112;
    VCa = 8.0000000000000000e+01;

    V = -17.73006237;
    x = -0.03817349158;

    par_[0] = Ko;
    par_[1] = shiftd;
    par_[2] = shiftf;
    par_[3] = gKw;
    par_[4] = gCa;
    par_[5] = VCa;

    u_[0] = V;
    u_[1] = x;

    return 0;
}

/*
 *  The remaining functions are just stubs.
 *  You will have to edit these by hand if you need these functions.
 */

/*
 *  BCND  Defines the boundary conditions
 */

int bcnd(integer ndim_, const doublereal *par_, const integer *icp_,
         integer nbc_, const doublereal *u0_, const doublereal *u1_, integer ijac_,
         doublereal *fb_, doublereal *dbc_)
{
    return 0;
}

/*
 *  ICND  Defines the integral conditions
 */

int icnd(integer ndim_, const doublereal *par_, const integer *icp_,
         integer nint_, const doublereal *u_, const doublereal *uold_,
         const doublereal *udot_, const doublereal *upold_, integer ijac_,
         doublereal *fi_, doublereal *dint_)
{
    return 0;
}

/*
 *  FOPT
 */

int fopt(integer ndim_, const doublereal *u_, const integer *icp_,
         const doublereal *par_, integer ijac_,
         doublereal *fs_, doublereal *dfdu_, doublereal *dfdp_)
{
    return 0;
}

/*
 *  PVLS
 */

int pvls(integer ndim_, const doublereal *u_, doublereal *par_)
{
    return 0;
}
