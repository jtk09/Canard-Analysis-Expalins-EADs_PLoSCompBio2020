/*
 *  Luofixedpoints_avf.c
 *
 *  AUTO C file for the vector field named: Luofixedpoints
 *
 *  This file was generated by the program VFGEN, version: 2.5.0
 *  Generated on 22-Nov-2019 at 12:16
 */

#include <math.h>
#include "auto_f2c.h"

/*
 *  FUNC  Defines the vector field and its derivatives
 */

int func(integer ndim_, const doublereal *u_, const integer *icp_,
         const doublereal *par_, integer ijac_,
         doublereal *f_, doublereal *dfdu_, doublereal *dfdp_)
{
    integer dfdu__dim1, dfdp__dim1;
    const double Ki = 145.0;
    const double Nao = 140.0;
    const double Nai = 18.0;
    const double PRNaK = 1.8329999999999999e-02;
    const double R = 8.3144626181532395e+00;
    const double Kelvin = 3.1014999999999998e+02;
    const double Faraday = 9.6485332900000003e+01;
    const double cda = 9.5000000000000001e-02;
    const double cdb = 7.0000000000000007e-02;
    const double cfa = 1.2000000000000000e-02;
    const double cfb = 6.4999999999999997e-03;
    const double cxa = 5.0000000000000001e-04;
    const double cxb = 1.2999999999999999e-03;
    const double cxi = 2.8370000000000002e+00;
    const double cK1a = 1.0200000000000000e+00;
    const double cK1b = 4.9124000000000001e-01;
    const double Vda = -5.0000000000000000e+00;
    const double Vdb = 4.4000000000000000e+01;
    const double Vfa = 2.8000000000000000e+01;
    const double Vfb = 3.0000000000000000e+01;
    const double Vxa = 5.0000000000000000e+01;
    const double Vxb = 2.0000000000000000e+01;
    const double Vxi1 = 7.7000000000000000e+01;
    const double Vxi2 = 3.5000000000000000e+01;
    const double sda1 = -1.0000000000000000e-02;
    const double sda2 = -7.1999999999999995e-02;
    const double sdb1 = -1.7000000000000001e-02;
    const double sdb2 = 5.0000000000000003e-02;
    const double sfa1 = -8.0000000000000002e-03;
    const double sfa2 = 1.4999999999999999e-01;
    const double sfb1 = -2.0000000000000000e-02;
    const double sfb2 = -2.0000000000000001e-01;
    const double sxa1 = 8.3000000000000004e-02;
    const double sxa2 = 5.7000000000000002e-02;
    const double sxb1 = -5.9999999999999998e-02;
    const double sxb2 = -4.0000000000000001e-02;
    const double sxi = 4.0000000000000001e-02;
    const double sK1a = 2.3849999999999999e-01;
    const double sK1b1 = 8.0320000000000003e-02;
    const double sK1b2 = 6.1749999999999999e-02;
    const double sK1b3 = -5.1429999999999998e-01;
    const double sKp = 1.6722408026755853e-01;
    const double gK1w = 6.0470000000000002e-01;
    const double gKp = 1.8300000000000000e-02;
    const double gb = 3.9210000000000002e-02;
    const double VKp = 7.4880000000000004e+00;
    const double Vb = 5.9869999999999997e+01;
    double V, d, f, x;
    double C, Ko, shiftd, shiftf, gKw, gCa, VCa;
    double gK, gK1, VK, VK1, alphad_inf, betad_inf, alphad_tau, betad_tau, alphaf_inf, betaf_inf, alphaf_tau, betaf_tau, alphax, betax, taud, tauf, taux, dinf, finf, xinf, xi, alphaK1, betaK1, K1inf, Kp, ICa, IK, IK1, IKp, Ib;

    dfdu__dim1 = ndim_;
    dfdp__dim1 = ndim_;

    V          = u_[0];
    d          = u_[1];
    f          = u_[2];
    x          = u_[3];

    C          = par_[0];
    Ko         = par_[1];
    shiftd     = par_[2];
    shiftf     = par_[3];
    gKw        = par_[4];
    gCa        = par_[5];
    VCa        = par_[6];

    gK = 4.3033148291193524e-01*gKw*pow(Ko,(1.0/2.0));
    gK1 = 4.3033148291193524e-01*pow(Ko,(1.0/2.0))*gK1w;
    VK = 1.0/Faraday*log(( PRNaK*Nao+Ko)/( Ki+PRNaK*Nai))*R*Kelvin;
    VK1 = 1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin;
    alphad_inf = exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda;
    betad_inf = exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb;
    alphad_tau = cda/( exp(sda2*( Vda+V))+1.0)*exp(( Vda+V)*sda1);
    betad_tau = exp(sdb1*( V+Vdb))/( exp(sdb2*( V+Vdb))+1.0)*cdb;
    alphaf_inf = cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0);
    betaf_inf = cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0);
    alphaf_tau = cfa/( exp(sfa2*( V+Vfa))+1.0)*exp(sfa1*( V+Vfa));
    betaf_tau = exp(( Vfb+V)*sfb1)/( exp(sfb2*( Vfb+V))+1.0)*cfb;
    alphax = exp(sxa1*( Vxa+V))*cxa/( exp(sxa2*( Vxa+V))+1.0);
    betax = exp(( V+Vxb)*sxb1)/( exp(( V+Vxb)*sxb2)+1.0)*cxb;
    taud = 1.0/( betad_tau+alphad_tau);
    tauf = 1.0/( alphaf_tau+betaf_tau);
    taux = 1.0/( alphax+betax);
    dinf = alphad_inf/( alphad_inf+betad_inf);
    finf = 1.0/( alphaf_inf+betaf_inf)*alphaf_inf;
    xinf = 1.0/( alphax+betax)*alphax;
    xi = ( exp(( Vxi1+V)*sxi)-1.0)*cxi/( Vxi1+V)/exp(( Vxi2+V)*sxi);
    alphaK1 = 1.0/( exp(( V-VK1-5.9215000000000003e+01)*sK1a)+1.0)*cK1a;
    betaK1 = 1.0/( exp(( V-VK1+4.7530000000000001e+00)*sK1b3)+1.0)*( cK1b*exp(sK1b1*( V-VK1+5.4760000000000000e+00))+exp(sK1b2*( V-VK1-5.9430999999999995e+02)));
    K1inf = 1.0/( alphaK1+betaK1)*alphaK1;
    Kp = 1.0/( exp(sKp*( VKp-V))+1.0);
    ICa = f*( V-VCa)*gCa*d;
    IK = -xi*x*( VK-V)*gK;
    IK1 = gK1*K1inf*( V-VK1);
    IKp = Kp*gKp*( V-VK1);
    Ib = gb*( V+Vb);

    /*
     *  The vector field
     */

    f_[0] = -1.0/C*( Ib+IK+IK1+IKp+ICa);
    f_[1] = 1.0/C*( dinf-d)/taud;
    f_[2] = -1.0/tauf*( f-finf);
    f_[3] = -1.0/taux*( x-xinf);

    if (ijac_ == 0) {
        return 0;
    }

    /*
     *  The Jacobian
     */

    ARRAY2D(dfdu_,0,0) = -1.0/C*( gb+-4.3033148291193524e-01*1.0/pow( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0,2.0)/( 1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)*cK1a+( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0))*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin)*pow(Ko,(1.0/2.0))*gK1w*cK1a*sK1a*exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+4.3033148291193524e-01*( exp(( Vxi1+V)*sxi)-1.0)*cxi*gKw*pow(Ko,(1.0/2.0))/( Vxi1+V)*x/exp(( Vxi2+V)*sxi)+4.3033148291193524e-01*( exp(( Vxi1+V)*sxi)-1.0)*cxi*gKw*pow(Ko,(1.0/2.0))/( Vxi1+V)*x/exp(( Vxi2+V)*sxi)*sxi*( 1.0/Faraday*log(( PRNaK*Nao+Ko)/( Ki+PRNaK*Nai))*R*Kelvin-V)+4.3033148291193524e-01*1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)/( 1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)*cK1a+( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0))*pow(Ko,(1.0/2.0))*gK1w*cK1a+4.3033148291193524e-01*1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)/pow( 1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)*cK1a+( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0),2.0)*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin)*( ( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/pow( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0,2.0)*exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))*sK1b3-( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)*sK1b2+cK1b*sK1b1*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0)+1.0/pow( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0,2.0)*cK1a*sK1a*exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a))*pow(Ko,(1.0/2.0))*gK1w*cK1a+4.3033148291193524e-01*( exp(( Vxi1+V)*sxi)-1.0)*cxi*gKw*pow(Ko,(1.0/2.0))/pow( Vxi1+V,2.0)*x/exp(( Vxi2+V)*sxi)*( 1.0/Faraday*log(( PRNaK*Nao+Ko)/( Ki+PRNaK*Nai))*R*Kelvin-V)+1.0/( exp(sKp*( VKp-V))+1.0)*gKp+( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin)*sKp/pow( exp(sKp*( VKp-V))+1.0,2.0)*gKp*exp(sKp*( VKp-V))+-4.3033148291193524e-01*cxi*gKw*pow(Ko,(1.0/2.0))/( Vxi1+V)*exp(( Vxi1+V)*sxi)*x/exp(( Vxi2+V)*sxi)*sxi*( 1.0/Faraday*log(( PRNaK*Nao+Ko)/( Ki+PRNaK*Nai))*R*Kelvin-V)+f*gCa*d);
    ARRAY2D(dfdu_,0,1) = -1.0/C*f*( V-VCa)*gCa;
    ARRAY2D(dfdu_,0,2) = -1.0/C*( V-VCa)*gCa*d;
    ARRAY2D(dfdu_,0,3) = 4.3033148291193524e-01*1.0/C*( exp(( Vxi1+V)*sxi)-1.0)*cxi*gKw*pow(Ko,(1.0/2.0))/( Vxi1+V)/exp(( Vxi2+V)*sxi)*( 1.0/Faraday*log(( PRNaK*Nao+Ko)/( Ki+PRNaK*Nai))*R*Kelvin-V);
    ARRAY2D(dfdu_,1,0) = -1.0/C*( sda2*exp(( Vda+V-shiftd)*sda1)/pow( exp(sda2*( Vda+V-shiftd))+1.0,2.0)*cda*exp(sda2*( Vda+V-shiftd))/( exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda)+( sdb1*exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb-sda2*exp(( Vda+V-shiftd)*sda1)/pow( exp(sda2*( Vda+V-shiftd))+1.0,2.0)*cda*exp(sda2*( Vda+V-shiftd))-exp(( V+Vdb-shiftd)*sdb2)*exp(( V+Vdb-shiftd)*sdb1)/pow( exp(( V+Vdb-shiftd)*sdb2)+1.0,2.0)*sdb2*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda*sda1)*exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda/pow( exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda,2.0)-exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda/( exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda)*sda1)*( exp(sdb1*( V+Vdb))/( exp(sdb2*( V+Vdb))+1.0)*cdb+cda/( exp(sda2*( Vda+V))+1.0)*exp(( Vda+V)*sda1))+1.0/C*( exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda/( exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda)-d)*( cda*sda1/( exp(sda2*( Vda+V))+1.0)*exp(( Vda+V)*sda1)-exp(sdb2*( V+Vdb))*exp(sdb1*( V+Vdb))/pow( exp(sdb2*( V+Vdb))+1.0,2.0)*sdb2*cdb-exp(sda2*( Vda+V))*sda2*cda/pow( exp(sda2*( Vda+V))+1.0,2.0)*exp(( Vda+V)*sda1)+exp(sdb1*( V+Vdb))*sdb1/( exp(sdb2*( V+Vdb))+1.0)*cdb);
    ARRAY2D(dfdu_,1,1) = -1.0/C*( exp(sdb1*( V+Vdb))/( exp(sdb2*( V+Vdb))+1.0)*cdb+cda/( exp(sda2*( Vda+V))+1.0)*exp(( Vda+V)*sda1));
    ARRAY2D(dfdu_,1,2) = 0.0;
    ARRAY2D(dfdu_,1,3) = 0.0;
    ARRAY2D(dfdu_,2,0) = -( f-cfa*exp(-sfa1*( shiftf-V-Vfa))/( cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0)+cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0))/( exp(-sfa2*( shiftf-V-Vfa))+1.0))*( sfa1*cfa/( exp(sfa2*( V+Vfa))+1.0)*exp(sfa1*( V+Vfa))-sfb2*exp(( Vfb+V)*sfb1)/pow( exp(sfb2*( Vfb+V))+1.0,2.0)*cfb*exp(sfb2*( Vfb+V))+exp(( Vfb+V)*sfb1)/( exp(sfb2*( Vfb+V))+1.0)*cfb*sfb1-cfa/pow( exp(sfa2*( V+Vfa))+1.0,2.0)*sfa2*exp(sfa1*( V+Vfa))*exp(sfa2*( V+Vfa)))-( cfa*exp(-sfa1*( shiftf-V-Vfa))/( cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0)+cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0))*exp(-sfa2*( shiftf-V-Vfa))*sfa2/pow( exp(-sfa2*( shiftf-V-Vfa))+1.0,2.0)+cfa*exp(-sfa1*( shiftf-V-Vfa))/pow( cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0)+cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0),2.0)/( exp(-sfa2*( shiftf-V-Vfa))+1.0)*( cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0)*sfb1-cfa*exp(-sfa1*( shiftf-V-Vfa))*exp(-sfa2*( shiftf-V-Vfa))*sfa2/pow( exp(-sfa2*( shiftf-V-Vfa))+1.0,2.0)-sfb2*cfb*exp(-( shiftf-Vfb-V)*sfb1)/pow( exp(-sfb2*( shiftf-Vfb-V))+1.0,2.0)*exp(-sfb2*( shiftf-Vfb-V))+sfa1*cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0))-sfa1*cfa*exp(-sfa1*( shiftf-V-Vfa))/( cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0)+cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0))/( exp(-sfa2*( shiftf-V-Vfa))+1.0))*( exp(( Vfb+V)*sfb1)/( exp(sfb2*( Vfb+V))+1.0)*cfb+cfa/( exp(sfa2*( V+Vfa))+1.0)*exp(sfa1*( V+Vfa)));
    ARRAY2D(dfdu_,2,1) = 0.0;
    ARRAY2D(dfdu_,2,2) = -exp(( Vfb+V)*sfb1)/( exp(sfb2*( Vfb+V))+1.0)*cfb-cfa/( exp(sfa2*( V+Vfa))+1.0)*exp(sfa1*( V+Vfa));
    ARRAY2D(dfdu_,2,3) = 0.0;
    ARRAY2D(dfdu_,3,0) =  ( exp(( V+Vxb)*sxb1)/( exp(( V+Vxb)*sxb2)+1.0)*cxb+exp(sxa1*( Vxa+V))*cxa/( exp(sxa2*( Vxa+V))+1.0))*( exp(sxa1*( Vxa+V))/pow( exp(( V+Vxb)*sxb1)/( exp(( V+Vxb)*sxb2)+1.0)*cxb+exp(sxa1*( Vxa+V))*cxa/( exp(sxa2*( Vxa+V))+1.0),2.0)*( exp(sxa1*( Vxa+V))*exp(sxa2*( Vxa+V))*cxa*sxa2/pow( exp(sxa2*( Vxa+V))+1.0,2.0)+exp(( V+Vxb)*sxb1)*exp(( V+Vxb)*sxb2)*sxb2/pow( exp(( V+Vxb)*sxb2)+1.0,2.0)*cxb-exp(( V+Vxb)*sxb1)/( exp(( V+Vxb)*sxb2)+1.0)*cxb*sxb1-exp(sxa1*( Vxa+V))*sxa1*cxa/( exp(sxa2*( Vxa+V))+1.0))*cxa/( exp(sxa2*( Vxa+V))+1.0)-exp(sxa1*( Vxa+V))*exp(sxa2*( Vxa+V))/( exp(( V+Vxb)*sxb1)/( exp(( V+Vxb)*sxb2)+1.0)*cxb+exp(sxa1*( Vxa+V))*cxa/( exp(sxa2*( Vxa+V))+1.0))*cxa*sxa2/pow( exp(sxa2*( Vxa+V))+1.0,2.0)+exp(sxa1*( Vxa+V))/( exp(( V+Vxb)*sxb1)/( exp(( V+Vxb)*sxb2)+1.0)*cxb+exp(sxa1*( Vxa+V))*cxa/( exp(sxa2*( Vxa+V))+1.0))*sxa1*cxa/( exp(sxa2*( Vxa+V))+1.0))-( exp(sxa1*( Vxa+V))/( exp(( V+Vxb)*sxb1)/( exp(( V+Vxb)*sxb2)+1.0)*cxb+exp(sxa1*( Vxa+V))*cxa/( exp(sxa2*( Vxa+V))+1.0))*cxa/( exp(sxa2*( Vxa+V))+1.0)-x)*( exp(sxa1*( Vxa+V))*exp(sxa2*( Vxa+V))*cxa*sxa2/pow( exp(sxa2*( Vxa+V))+1.0,2.0)+exp(( V+Vxb)*sxb1)*exp(( V+Vxb)*sxb2)*sxb2/pow( exp(( V+Vxb)*sxb2)+1.0,2.0)*cxb-exp(( V+Vxb)*sxb1)/( exp(( V+Vxb)*sxb2)+1.0)*cxb*sxb1-exp(sxa1*( Vxa+V))*sxa1*cxa/( exp(sxa2*( Vxa+V))+1.0));
    ARRAY2D(dfdu_,3,1) = 0.0;
    ARRAY2D(dfdu_,3,2) = 0.0;
    ARRAY2D(dfdu_,3,3) = -exp(( V+Vxb)*sxb1)/( exp(( V+Vxb)*sxb2)+1.0)*cxb-exp(sxa1*( Vxa+V))*cxa/( exp(sxa2*( Vxa+V))+1.0);

    if (ijac_ == 1) {
        return 0;
    }

    /*
     *  The Jacobian with respect to the parameters.
     */

    ARRAY2D(dfdp_,0,0) = -1.0/(C*C)*( -4.3033148291193524e-01*1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)/( 1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)*cK1a+( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0))*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin)*pow(Ko,(1.0/2.0))*gK1w*cK1a-( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin)/( exp(sKp*( VKp-V))+1.0)*gKp-gb*( V+Vb)+4.3033148291193524e-01*( exp(( Vxi1+V)*sxi)-1.0)*cxi*gKw*pow(Ko,(1.0/2.0))/( Vxi1+V)*x/exp(( Vxi2+V)*sxi)*( 1.0/Faraday*log(( PRNaK*Nao+Ko)/( Ki+PRNaK*Nai))*R*Kelvin-V)-f*( V-VCa)*gCa*d);
    ARRAY2D(dfdp_,0,1) = 1.0/C*( -2.1516574145596762e-01*1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)/( 1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)*cK1a+( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0))*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin)*pow(Ko,-(1.0/2.0))*gK1w*cK1a+1.0/Faraday/( exp(sKp*( VKp-V))+1.0)/Ko*R*gKp*Kelvin+-4.3033148291193524e-01*1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)*( 1.0/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0)*( cK1b/Faraday*sK1b1/Ko*R*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00))*Kelvin+exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)/Faraday/Ko*R*sK1b2*Kelvin)-1.0/pow( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0,2.0)/Faraday/Ko*R*cK1a*Kelvin*sK1a*exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)-( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/Faraday/Ko*R/pow( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0,2.0)*exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))*Kelvin*sK1b3)/pow( 1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)*cK1a+( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0),2.0)*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin)*pow(Ko,(1.0/2.0))*gK1w*cK1a+4.3033148291193524e-01*1.0/( PRNaK*Nao+Ko)/Faraday*( exp(( Vxi1+V)*sxi)-1.0)*cxi*gKw*pow(Ko,(1.0/2.0))/( Vxi1+V)*R*x/exp(( Vxi2+V)*sxi)*Kelvin+4.3033148291193524e-01*1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)/( 1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)*cK1a+( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0))/Faraday*pow(Ko,-(1.0/2.0))*gK1w*R*cK1a*Kelvin+2.1516574145596762e-01*( exp(( Vxi1+V)*sxi)-1.0)*cxi*gKw*pow(Ko,-(1.0/2.0))/( Vxi1+V)*x/exp(( Vxi2+V)*sxi)*( 1.0/Faraday*log(( PRNaK*Nao+Ko)/( Ki+PRNaK*Nai))*R*Kelvin-V)+-4.3033148291193524e-01*1.0/pow( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0,2.0)/( 1.0/( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a)+1.0)*cK1a+( exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9430999999999995e+02)*sK1b2)+cK1b*exp(sK1b1*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+5.4760000000000000e+00)))/( exp(sK1b3*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin+4.7530000000000001e+00))+1.0))*( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin)/Faraday*pow(Ko,-(1.0/2.0))*gK1w*R*cK1a*Kelvin*sK1a*exp(( V-1.0/Faraday*R*log(1.0/Ki*Ko)*Kelvin-5.9215000000000003e+01)*sK1a));
    ARRAY2D(dfdp_,0,2) = 0.0;
    ARRAY2D(dfdp_,0,3) = 0.0;
    ARRAY2D(dfdp_,0,4) = 4.3033148291193524e-01*1.0/C*( exp(( Vxi1+V)*sxi)-1.0)*cxi*pow(Ko,(1.0/2.0))/( Vxi1+V)*x/exp(( Vxi2+V)*sxi)*( 1.0/Faraday*log(( PRNaK*Nao+Ko)/( Ki+PRNaK*Nai))*R*Kelvin-V);
    ARRAY2D(dfdp_,0,5) = -1.0/C*f*( V-VCa)*d;
    ARRAY2D(dfdp_,0,6) = 1.0/C*f*gCa*d;
    ARRAY2D(dfdp_,1,0) = -1.0/(C*C)*( exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda/( exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda)-d)*( exp(sdb1*( V+Vdb))/( exp(sdb2*( V+Vdb))+1.0)*cdb+cda/( exp(sda2*( Vda+V))+1.0)*exp(( Vda+V)*sda1));
    ARRAY2D(dfdp_,1,1) = 0.0;
    ARRAY2D(dfdp_,1,2) = 1.0/C*( sda2*exp(( Vda+V-shiftd)*sda1)/pow( exp(sda2*( Vda+V-shiftd))+1.0,2.0)*cda*exp(sda2*( Vda+V-shiftd))/( exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda)+( sdb1*exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb-sda2*exp(( Vda+V-shiftd)*sda1)/pow( exp(sda2*( Vda+V-shiftd))+1.0,2.0)*cda*exp(sda2*( Vda+V-shiftd))-exp(( V+Vdb-shiftd)*sdb2)*exp(( V+Vdb-shiftd)*sdb1)/pow( exp(( V+Vdb-shiftd)*sdb2)+1.0,2.0)*sdb2*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda*sda1)*exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda/pow( exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda,2.0)-exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda/( exp(( V+Vdb-shiftd)*sdb1)/( exp(( V+Vdb-shiftd)*sdb2)+1.0)*cdb+exp(( Vda+V-shiftd)*sda1)/( exp(sda2*( Vda+V-shiftd))+1.0)*cda)*sda1)*( exp(sdb1*( V+Vdb))/( exp(sdb2*( V+Vdb))+1.0)*cdb+cda/( exp(sda2*( Vda+V))+1.0)*exp(( Vda+V)*sda1));
    ARRAY2D(dfdp_,1,3) = 0.0;
    ARRAY2D(dfdp_,1,4) = 0.0;
    ARRAY2D(dfdp_,1,5) = 0.0;
    ARRAY2D(dfdp_,1,6) = 0.0;
    ARRAY2D(dfdp_,2,0) = 0.0;
    ARRAY2D(dfdp_,2,1) = 0.0;
    ARRAY2D(dfdp_,2,2) = 0.0;
    ARRAY2D(dfdp_,2,3) = ( cfa*exp(-sfa1*( shiftf-V-Vfa))/( cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0)+cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0))*exp(-sfa2*( shiftf-V-Vfa))*sfa2/pow( exp(-sfa2*( shiftf-V-Vfa))+1.0,2.0)+cfa*exp(-sfa1*( shiftf-V-Vfa))/pow( cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0)+cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0),2.0)/( exp(-sfa2*( shiftf-V-Vfa))+1.0)*( cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0)*sfb1-cfa*exp(-sfa1*( shiftf-V-Vfa))*exp(-sfa2*( shiftf-V-Vfa))*sfa2/pow( exp(-sfa2*( shiftf-V-Vfa))+1.0,2.0)-sfb2*cfb*exp(-( shiftf-Vfb-V)*sfb1)/pow( exp(-sfb2*( shiftf-Vfb-V))+1.0,2.0)*exp(-sfb2*( shiftf-Vfb-V))+sfa1*cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0))-sfa1*cfa*exp(-sfa1*( shiftf-V-Vfa))/( cfa*exp(-sfa1*( shiftf-V-Vfa))/( exp(-sfa2*( shiftf-V-Vfa))+1.0)+cfb*exp(-( shiftf-Vfb-V)*sfb1)/( exp(-sfb2*( shiftf-Vfb-V))+1.0))/( exp(-sfa2*( shiftf-V-Vfa))+1.0))*( exp(( Vfb+V)*sfb1)/( exp(sfb2*( Vfb+V))+1.0)*cfb+cfa/( exp(sfa2*( V+Vfa))+1.0)*exp(sfa1*( V+Vfa)));
    ARRAY2D(dfdp_,2,4) = 0.0;
    ARRAY2D(dfdp_,2,5) = 0.0;
    ARRAY2D(dfdp_,2,6) = 0.0;
    ARRAY2D(dfdp_,3,0) = 0.0;
    ARRAY2D(dfdp_,3,1) = 0.0;
    ARRAY2D(dfdp_,3,2) = 0.0;
    ARRAY2D(dfdp_,3,3) = 0.0;
    ARRAY2D(dfdp_,3,4) = 0.0;
    ARRAY2D(dfdp_,3,5) = 0.0;
    ARRAY2D(dfdp_,3,6) = 0.0;

    return 0;
}

/*
 *  STPNT  Gives a starting point
 */

int stpnt(integer ndim_, doublereal t_, doublereal *u_, doublereal *par_)
{
    double V, d, f, x;
    double C, Ko, shiftd, shiftf, gKw, gCa, VCa;

    /* Change the parameter values and the starting point to correct values! */

    C = 1.0000000000000000e+00;
    Ko = 5.4000000000000004e+00;
    shiftd = 0.0000000000000000e+00;
    shiftf = 0.0000000000000000e+00;
    gKw = 2.8199999999999997e-01;
    gCa = 8.9999999999999997e-02;
    VCa = 8.0000000000000000e+01;

    V = -8.4624897357714133e+01;
    d = 2.9579236344697423e-03;
    f = 9.9998151252237621e-01;
    x = 5.6004284184806470e-03;

    par_[0] = C;
    par_[1] = Ko;
    par_[2] = shiftd;
    par_[3] = shiftf;
    par_[4] = gKw;
    par_[5] = gCa;
    par_[6] = VCa;

    u_[0] = V;
    u_[1] = d;
    u_[2] = f;
    u_[3] = x;

    return 0;
}

/*
 *  The remaining functions are just stubs.
 *  You will have to edit these by hand if you need these functions.
 */

/*
 *  BCND  Defines the boundary conditions
 */

int bcnd(integer ndim_, const doublereal *par_, const integer *icp_,
         integer nbc_, const doublereal *u0_, const doublereal *u1_, integer ijac_,
         doublereal *fb_, doublereal *dbc_)
{
    return 0;
}

/*
 *  ICND  Defines the integral conditions
 */

int icnd(integer ndim_, const doublereal *par_, const integer *icp_,
         integer nint_, const doublereal *u_, const doublereal *uold_,
         const doublereal *udot_, const doublereal *upold_, integer ijac_,
         doublereal *fi_, doublereal *dint_)
{
    return 0;
}

/*
 *  FOPT
 */

int fopt(integer ndim_, const doublereal *u_, const integer *icp_,
         const doublereal *par_, integer ijac_,
         doublereal *fs_, doublereal *dfdu_, doublereal *dfdp_)
{
    return 0;
}

/*
 *  PVLS
 */

int pvls(integer ndim_, const doublereal *u_, doublereal *par_)
{
    return 0;
}
